{% extends "base.html" %}

{% block title %}Accueil - Syst√®me de D√©tection EPI{% endblock %}

{% block content %}
<div style="padding: 60px 20px; max-width: 1600px; margin: 0 auto;">
    <!-- Hero Section -->
    <div style="text-align: center; margin-bottom: 80px; position: relative; z-index: 1;">
        <h1 style="font-size: 3.5em; margin: 0 0 20px 0; line-height: 1.2;">
            <span style="background: linear-gradient(135deg, #8B1538 0%, #4169E1 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                <i class="fas fa-hard-hat"></i> D√©tection Intelligente d'EPI
            </span>
        </h1>
        <p style="font-size: 1.3em; color: #aaa; margin: 20px 0; max-width: 600px; margin-left: auto; margin-right: auto;">
            Surveillance automatique des √âquipements de Protection Individuelle par Intelligence Artificielle en temps r√©el
        </p>
        
        <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; margin-top: 40px;">
            <a href="{{ url_for('upload_file') }}" class="glass-dark" style="padding: 15px 35px; border-radius: 12px; color: #fff; text-decoration: none; display: inline-flex; align-items: center; gap: 10px; border: 1px solid rgba(139, 21, 56, 0.3); background: rgba(139, 21, 56, 0.1); backdrop-filter: blur(10px); transition: all 0.3s ease;">
                <i class="fas fa-upload"></i> Commencer
            </a>
            <a href="{{ url_for('dashboard') }}" class="glass-dark" style="padding: 15px 35px; border-radius: 12px; color: #fff; text-decoration: none; display: inline-flex; align-items: center; gap: 10px; border: 1px solid rgba(65, 105, 225, 0.3); background: rgba(65, 105, 225, 0.1); backdrop-filter: blur(10px); transition: all 0.3s ease;">
                <i class="fas fa-tachometer-alt"></i> Dashboard
            </a>
            <a href="{{ url_for('tinkercad_page') }}" class="glass-dark" style="padding: 15px 35px; border-radius: 12px; color: #fff; text-decoration: none; display: inline-flex; align-items: center; gap: 10px; border: 1px solid rgba(75, 192, 75, 0.3); background: rgba(75, 192, 75, 0.1); backdrop-filter: blur(10px); transition: all 0.3s ease;">
                <i class="fas fa-microchip"></i> IoT Simulator
            </a>
        </div>
    </div>

    <!-- Caract√©ristiques Principales -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 25px; margin-bottom: 80px;">
        <div class="glass-dark" style="padding: 35px; border-radius: 16px; border: 1px solid rgba(139, 21, 56, 0.2); text-align: center; transition: all 0.3s ease;">
            <div style="font-size: 3em; color: #8B1538; margin-bottom: 15px;">
                <i class="fas fa-robot"></i>
            </div>
            <h3 style="color: #fff; margin: 15px 0; font-size: 1.3em;">IA Avanc√©e</h3>
            <p style="color: #aaa; margin: 10px 0;">D√©tection en temps r√©el avec YOLOv5, pr√©cision sup√©rieure √† 95%</p>
        </div>

        <div class="glass-dark" style="padding: 35px; border-radius: 16px; border: 1px solid rgba(65, 105, 225, 0.2); text-align: center; transition: all 0.3s ease;">
            <div style="font-size: 3em; color: #4169E1; margin-bottom: 15px;">
                <i class="fas fa-shield-alt"></i>
            </div>
            <h3 style="color: #fff; margin: 15px 0; font-size: 1.3em;">EPI Complets</h3>
            <p style="color: #aaa; margin: 10px 0;">D√©tection des casques, gilets et lunettes de s√©curit√©</p>
        </div>

        <div class="glass-dark" style="padding: 35px; border-radius: 16px; border: 1px solid rgba(75, 192, 75, 0.2); text-align: center; transition: all 0.3s ease;">
            <div style="font-size: 3em; color: #4bc0a8; margin-bottom: 15px;">
                <i class="fas fa-chart-line"></i>
            </div>
            <h3 style="color: #fff; margin: 15px 0; font-size: 1.3em;">Analytique Avanc√©e</h3>
            <p style="color: #aaa; margin: 10px 0;">Dashboard interactif avec 6 types de graphiques</p>
        </div>

        <div class="glass-dark" style="padding: 35px; border-radius: 16px; border: 1px solid rgba(255, 165, 0, 0.2); text-align: center; transition: all 0.3s ease;">
            <div style="font-size: 3em; color: #ffa500; margin-bottom: 15px;">
                <i class="fas fa-bell"></i>
            </div>
            <h3 style="color: #fff; margin: 15px 0; font-size: 1.3em;">Alertes Instantan√©es</h3>
            <p style="color: #aaa; margin: 10px 0;">Notifications en temps r√©el pour non-conformit√©</p>
        </div>

        <div class="glass-dark" style="padding: 35px; border-radius: 16px; border: 1px solid rgba(100, 200, 255, 0.2); text-align: center; transition: all 0.3s ease;">
            <div style="font-size: 3em; color: #64c8ff; margin-bottom: 15px;">
                <i class="fas fa-database"></i>
            </div>
            <h3 style="color: #fff; margin: 15px 0; font-size: 1.3em;">Historique Complet</h3>
            <p style="color: #aaa; margin: 10px 0;">Stockage et analyse compl√®te des d√©tections</p>
        </div>

        <div class="glass-dark" style="padding: 35px; border-radius: 16px; border: 1px solid rgba(200, 100, 255, 0.2); text-align: center; transition: all 0.3s ease;">
            <div style="font-size: 3em; color: #c864ff; margin-bottom: 15px;">
                <i class="fas fa-cogs"></i>
            </div>
            <h3 style="color: #fff; margin: 15px 0; font-size: 1.3em;">Int√©gration Facile</h3>
            <p style="color: #aaa; margin: 10px 0;">API REST, Export PDF, Power BI, MySQL</p>
        </div>
    </div>

    <!-- Statistiques en Direct -->
    <div style="margin-bottom: 80px;">
        <h2 style="font-size: 2.2em; color: #fff; text-align: center; margin-bottom: 40px;">
            <i class="fas fa-chart-bar"></i> Statistiques en Direct
        </h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
            <div class="glass-dark" style="padding: 30px; border-radius: 16px; border: 1px solid rgba(139, 21, 56, 0.3); text-align: center;">
                <div style="font-size: 2.8em; color: #8B1538; margin-bottom: 10px;"><i class="fas fa-user-check"></i></div>
                <div style="font-size: 2.5em; font-weight: bold; color: #fff; margin-bottom: 10px;" id="liveComplianceStat">--</div>
                <div style="color: #aaa; font-size: 0.95em;">Taux de Conformit√©</div>
            </div>

            <div class="glass-dark" style="padding: 30px; border-radius: 16px; border: 1px solid rgba(65, 105, 225, 0.3); text-align: center;">
                <div style="font-size: 2.8em; color: #4169E1; margin-bottom: 10px;"><i class="fas fa-users"></i></div>
                <div style="font-size: 2.5em; font-weight: bold; color: #fff; margin-bottom: 10px;" id="livePersonsStat">--</div>
                <div style="color: #aaa; font-size: 0.95em;">Personnes D√©tect√©es</div>
            </div>

            <div class="glass-dark" style="padding: 30px; border-radius: 16px; border: 1px solid rgba(75, 192, 75, 0.3); text-align: center;">
                <div style="font-size: 2.8em; color: #4bc0a8; margin-bottom: 10px;"><i class="fas fa-hard-hat"></i></div>
                <div style="font-size: 2.5em; font-weight: bold; color: #fff; margin-bottom: 10px;" id="liveHelmetsStat">--</div>
                <div style="color: #aaa; font-size: 0.95em;">Casques Port√©s</div>
            </div>

            <div class="glass-dark" style="padding: 30px; border-radius: 16px; border: 1px solid rgba(255, 107, 107, 0.3); text-align: center;">
                <div style="font-size: 2.8em; color: #ff6b6b; margin-bottom: 10px;"><i class="fas fa-bell"></i></div>
                <div style="font-size: 2.5em; font-weight: bold; color: #fff; margin-bottom: 10px;" id="liveAlertsStat">--</div>
                <div style="color: #aaa; font-size: 0.95em;">Alertes Actives</div>
            </div>
        </div>
    </div>

    <!-- Processus D√©monstration -->
    <div style="margin-bottom: 80px;">
        <h2 style="font-size: 2.2em; color: #fff; text-align: center; margin-bottom: 40px;">
            <i class="fas fa-play-circle"></i> Processus en 4 √âtapes
        </h2>
        <div style="display: flex; align-items: center; gap: 20px; margin-bottom: 40px; flex-wrap: wrap; justify-content: center;">
            <div class="glass-dark" style="padding: 30px; border-radius: 16px; border: 1px solid rgba(139, 21, 56, 0.3); text-align: center; flex: 0 0 calc(25% - 15px); min-width: 180px;">
                <div style="font-size: 2.5em; color: #8B1538; margin-bottom: 15px;"><i class="fas fa-upload"></i></div>
                <h3 style="color: #fff; margin: 10px 0;">1. Upload</h3>
                <p style="color: #aaa; font-size: 0.9em; margin: 10px 0;">T√©l√©chargez votre image</p>
            </div>

            <div style="font-size: 2.5em; color: #4169E1;">‚Üí</div>

            <div class="glass-dark" style="padding: 30px; border-radius: 16px; border: 1px solid rgba(65, 105, 225, 0.3); text-align: center; flex: 0 0 calc(25% - 15px); min-width: 180px;">
                <div style="font-size: 2.5em; color: #4169E1; margin-bottom: 15px;"><i class="fas fa-eye"></i></div>
                <h3 style="color: #fff; margin: 10px 0;">2. D√©tection</h3>
                <p style="color: #aaa; font-size: 0.9em; margin: 10px 0;">L'IA analyse en temps r√©el</p>
            </div>

            <div style="font-size: 2.5em; color: #4bc0a8;">‚Üí</div>

            <div class="glass-dark" style="padding: 30px; border-radius: 16px; border: 1px solid rgba(75, 192, 75, 0.3); text-align: center; flex: 0 0 calc(25% - 15px); min-width: 180px;">
                <div style="font-size: 2.5em; color: #4bc0a8; margin-bottom: 15px;"><i class="fas fa-chart-pie"></i></div>
                <h3 style="color: #fff; margin: 10px 0;">3. Analyse</h3>
                <p style="color: #aaa; font-size: 0.9em; margin: 10px 0;">Visualisez les r√©sultats</p>
            </div>

            <div style="font-size: 2.5em; color: #ffa500;">‚Üí</div>

            <div class="glass-dark" style="padding: 30px; border-radius: 16px; border: 1px solid rgba(255, 165, 0, 0.3); text-align: center; flex: 0 0 calc(25% - 15px); min-width: 180px;">
                <div style="font-size: 2.5em; color: #ffa500; margin-bottom: 15px;"><i class="fas fa-file-pdf"></i></div>
                <h3 style="color: #fff; margin: 10px 0;">4. Export</h3>
                <p style="color: #aaa; font-size: 0.9em; margin: 10px 0;">G√©n√©rez un rapport PDF</p>
            </div>
        </div>

        <div style="text-align: center;">
            <a href="{{ url_for('upload_file') }}" class="glass-dark" style="padding: 18px 45px; border-radius: 12px; color: #fff; text-decoration: none; display: inline-flex; align-items: center; gap: 12px; border: 1px solid rgba(139, 21, 56, 0.3); background: linear-gradient(135deg, rgba(139, 21, 56, 0.2), rgba(65, 105, 225, 0.2)); backdrop-filter: blur(10px); font-weight: 600; font-size: 1.1em; transition: all 0.3s ease;">
                <i class="fas fa-rocket"></i> Essayer Maintenant
            </a>
        </div>
    </div>

    <!-- Section Technologie -->
    <div class="glass-dark" style="padding: 40px; border-radius: 16px; border: 1px solid rgba(100, 200, 255, 0.2); margin-bottom: 80px;">
        <h2 style="color: #fff; margin-top: 0; margin-bottom: 30px;">
            <i class="fas fa-cogs"></i> Stack Technologique
        </h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
            <div style="padding: 20px; background: rgba(139, 21, 56, 0.1); border-radius: 12px; border: 1px solid rgba(139, 21, 56, 0.2);">
                <div style="color: #8B1538; font-weight: 600; margin-bottom: 8px;">ü§ñ ML/AI</div>
                <div style="color: #aaa; font-size: 0.9em;">PyTorch, YOLOv5, Ultralytics</div>
            </div>
            <div style="padding: 20px; background: rgba(65, 105, 225, 0.1); border-radius: 12px; border: 1px solid rgba(65, 105, 225, 0.2);">
                <div style="color: #4169E1; font-weight: 600; margin-bottom: 8px;">üñ•Ô∏è Backend</div>
                <div style="color: #aaa; font-size: 0.9em;">Python 3.13, Flask, SQLAlchemy</div>
            </div>
            <div style="padding: 20px; background: rgba(75, 192, 75, 0.1); border-radius: 12px; border: 1px solid rgba(75, 192, 75, 0.2);">
                <div style="color: #4bc0a8; font-weight: 600; margin-bottom: 8px;">üé® Frontend</div>
                <div style="color: #aaa; font-size: 0.9em;">Bootstrap 5, Chart.js 4, Glassmorphism</div>
            </div>
            <div style="padding: 20px; background: rgba(255, 165, 0, 0.1); border-radius: 12px; border: 1px solid rgba(255, 165, 0, 0.2);">
                <div style="color: #ffa500; font-weight: 600; margin-bottom: 8px;">üîå Int√©grations</div>
                <div style="color: #aaa; font-size: 0.9em;">MySQL, Power BI, PDF Export, API REST</div>
            </div>
        </div>
    </div>
</div>

<style>
    .glass-dark:hover {
        transform: translateY(-5px);
        border-color: rgba(255, 255, 255, 0.15);
        background: rgba(31, 41, 55, 0.8);
    }
</style>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Mettre √† jour les stats en direct
    function updateLiveStats() {
        fetch('/api/stats')
            .then(response => response.json())
            .then(data => {
                console.log('Donn√©es stats re√ßues:', data);
                
                // Taux de conformit√©
                if (data.compliance_rate !== undefined) {
                    document.getElementById('liveComplianceStat').textContent = 
                        Math.round(data.compliance_rate) + '%';
                } else {
                    document.getElementById('liveComplianceStat').textContent = '--';
                }
                
                // Total personnes
                if (data.total_persons !== undefined) {
                    document.getElementById('livePersonsStat').textContent = 
                        data.total_persons;
                } else {
                    document.getElementById('livePersonsStat').textContent = '--';
                }
                
                // Casques port√©s (with_helmet)
                if (data.with_helmet !== undefined) {
                    document.getElementById('liveHelmetsStat').textContent = 
                        data.with_helmet;
                } else {
                    document.getElementById('liveHelmetsStat').textContent = '--';
                }
                
                // Alertes actives
                if (data.alerts !== undefined) {
                    document.getElementById('liveAlertsStat').textContent = 
                        data.alerts;
                } else {
                    document.getElementById('liveAlertsStat').textContent = '--';
                }
            })
            .catch(err => {
                console.error('Erreur API /api/stats:', err);
                // Gardez les valeurs par d√©faut si l'API ne r√©pond pas
            });
    }
    
    // Mettre √† jour toutes les 5 secondes pour donn√©es quasi en temps r√©el
    updateLiveStats();
    setInterval(updateLiveStats, 5000);
});
</script>
{% endblock %}